============================================================
==> commandes exécutées
+ debut_restaurant 10 2
+ : -> debut_restaurant
+ [ 2 -lt 2 ]
+ local duree_repas=10
+ shift
+ local tables=2
+ islinux
+ uname
+ [ xLinux = xLinux ]
+ ls /dev/shm
+ echo État initial des shm
État initial des shm
+ cat /tmp/test-110-57878.m1
+ PID_R=57885
+ msleep 40
+ [ 1 != 1 ]+ 
+ local ms=40./restaurant
 10 2
+ mstos 40
+ [ 1 != 1 ]
+ local ms=40
+ echo scale=5;40/1000
+ bc
+ sleep .04000
+ ps_existe 57885 Le restaurateur n'est plus là
+ [ 2 != 2 ]
+ local pid=57885 msg=Le restaurateur n'est plus là
+ kill -0 57885
+ islinux
+ uname
+ [ xLinux = xLinux ]
+ ls /dev/shm
+ echo État des shm après création
État des shm après création
+ cat /tmp/test-110-57878.m2
leViandard
+ cmp -s /tmp/test-110-57878.m1 /tmp/test-110-57878.m2
+ : <- debut_restaurant
+ fermeture_restaurant
+ : -> fermeture_restaurant
+ [ 0 != 0 ]
+ PID_F=57894
+ msleep 40
+ [ 1 != 1 ]
+ local ms=40
+ ./fermeture
+ mstos 40
+ [ 1 != 1 ]
+ local ms=40
+ echo scale=5;40/1000
+ bc
+ sleep .04000
+ ps_termine 57894 'fermeture' aurait dû se terminer rapidement
+ [ 2 != 2 ]
+ local pid=57894 msg='fermeture' aurait dû se terminer rapidement
+ kill -0 57894
+ : <- fermeture_restaurant
+ fin_restaurant 0 0
+ : -> fin_restaurant
+ [ 2 != 2 ]
+ local nc=0 ng=0
+ ps_termine 57885 Le restaurateur n'a pas terminé
+ [ 2 != 2 ]
+ local pid=57885 msg=Le restaurateur n'a pas terminé
+ kill -0 57885
+ wait 57885
+ islinux
+ uname
+ [ xLinux = xLinux ]
+ ls /dev/shm
+ echo État des shm à la fin
État des shm à la fin
+ cat /tmp/test-110-57878.m2
+ cmp -s /tmp/test-110-57878.m1 /tmp/test-110-57878.m2
+ grep -q 0 conv /tmp/test-110-57878.r
+ grep -q 0 groupe /tmp/test-110-57878.r
+ : <- fin_restaurant
+ logs_aux
+ set +x
============================================================
==> Fichier de log auxiliaire /tmp/test-110-57878.f
============================================================
==> Fichier de log auxiliaire /tmp/test-110-57878.m1
============================================================
==> Fichier de log auxiliaire /tmp/test-110-57878.m2
============================================================
==> Fichier de log auxiliaire /tmp/test-110-57878.r
initialisation
init_cahier
allocation salle
creation et ouverture resto
creation restaurant
ouverture_fermeture_restaurant
debut boucle
ouverture_fermeture_restaurant
0 convives servis dans 0 groupes
n_wait
destruction restaurant
============================================================
==> /dev/shm
